---

import { Image } from "astro:assets"
import logoImage from "../../public/img/logo.svg"
import { Debug } from "astro:components";
const base_url = import.meta.env.BASE_URL

const { expand = true } = Astro.props;

let width = expand ? "w-3/4 lg:w-full" : ""
let top_menu = expand ? "hidden lg:flex" : "hidden"
---

<script>
	const pageContent = document.querySelector('#page-content') as HTMLElement;
	const header = document.querySelector('#header') as HTMLElement;
	const banner = document.querySelector('#banner-img') as HTMLElement;
	const hamburger = document.querySelector('#hamburger') as HTMLElement;
	const smallMenu = document.querySelector('#sm-menu') as HTMLElement;
	const largeMenu = document.querySelector('#lg-menu') as HTMLElement;

	function switchMenuType() {
		pageContent.classList.toggle('fix-content');
		smallMenu.classList.toggle('hide-nav');
		smallMenu.classList.toggle('show-nav');
	}

	function updateStickyOffset() {
		const height = header.offsetHeight;
		const viewportHeight = window.innerHeight;

		if (largeMenu.checkVisibility()) {
			header.style.top = `-${height / 2}px`;
			header.style.top = `-${height - 128}px`;
			if(smallMenu.classList.contains('show-nav')) {
				switchMenuType();
			}
		}
		else {
			smallMenu.style.top = `${height}px`;
			smallMenu.style.height = `${viewportHeight - height}px`;
		}
	}
	
	updateStickyOffset();

	hamburger.addEventListener('click', switchMenuType);
	window.addEventListener('resize', updateStickyOffset);

	const observer = new ResizeObserver(updateStickyOffset);
	observer.observe(document.querySelector('#header'));
</script>

<!-- includes mobile menu -->
<header id="header" class="lg:sticky lg:top-0 bg-white flex flex-col items-center h-full w-full font-serif px-8 lg:px-0 py-6 border-b-1">
	<!-- just the header -->
	<div class="flex flex-row lg:flex-col w-full text-4xl items-center lg:h-max">
		<div class=`${width} max-h-[64px] lg:max-h-full`>
			<Image src={logoImage} alt="" id="banner" class="w-max max-h-[64px] lg:max-h-max" />		
		</div>

		<ul id="lg-menu" class=`resize-animate ${top_menu} ml-auto space-x-20 relative bottom-4 right-[8%]
					lg:text-2xl xl:text-3xl`>

			<li><a href=`${base_url}/articles` class="hover:text-p-red">Articles</a></li>
			<li><a href=`${base_url}/issues` class="hover:text-p-red">Issues</a></li>
			<li><a href=`${base_url}/contact` class="hover:text-p-red">Contact us</a></li>
			<li><a href=`${base_url}/about` class="hover:text-p-red">About</a></li>

		</ul>

		<div class=`w-1/4 lg:hidden text-right`>
			<button id="hamburger" onclick="toggleMenu()">
				<svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
				<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
				</svg>
			</button>
		</div>

	</div>
	<div id="sm-menu" class="text-2xl flex flex-col border-black hide-nav w-full bg-red-50 z-50 fixed items-center">
		<div class="py-4"><a href="#" class="hover:text-gray-400">Home</a></div>
		<div class="py-4"><a href="#" class="hover:text-gray-400">About</a></div>
		<div class="py-4"><a href="#" class="hover:text-gray-400">Services</a></div>
		<div class="py-4"><a href="#" class="hover:text-gray-400">Contact</a></div>
	</div>
</header>




	<!-- <nav class="flex items-center justify-end font-serif text-base grow space-x-20">
		<span><a class="text-black" href=`${import.meta.env.BASE_URL}/about`>About</a></span>
	</nav> 				top-[calc(64px+var(--spacing)*6*2)]"

 </div> -->

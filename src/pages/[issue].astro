---
import { getCollection } from "astro:content";
import Image from "astro/components/Image.astro";
import Wrapper from "@components/Wrapper";
import OuterBlock from "@components/OuterBlock";



export async function getStaticPaths() {
	const issueEntries = await getCollection('issues')
	return issueEntries.map((issue) => {
		return {
			params: { issue: issue.slug},
			props: { issue }
		};
	})
}

const { issue } = Astro.props
const { Content } = await issue.render()
let articles = await getCollection('articles', (a) => a.slug.split("/")[0].split("_")[1] == issue.slug);
articles = articles.sort((a, b) => a.data.order < b.data.order ? -1 : 1);

---


<!-- <Content title="Simple Blog">
	<div class="content container">	
		{articles.map((a) => <Preview issue={a} />)}
	</div>
</Content > -->


<Wrapper title="post-machina">	


	<div class=`flex flex-col items-center max-width py-12 border-b-2 border-black` style={`background-color: ${issue.data.colour}`} data-aos="fade-in">
		<Image src={issue.data.image} alt="" class="mb-8 w-min h-72" />
		<div class=`font-serif text-center`>
			<div class="mb-4"><a class="hover:text-p-red" href={`${import.meta.env.BASE_URL}/${issue.slug}`}>{issue.data.title}</a></div>
			<Content />
		</div>
	</div>
	

	<div class="bg-white">
		<div class="max-width flex flex-row py-4 flex-wrap justify-around items-stretch">
			{articles.map((i) => <OuterBlock article={i} colour={issue.data.colour} />)}
		</div>
	</div>
</Wrapper>
